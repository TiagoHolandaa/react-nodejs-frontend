{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Tiago - DARM\\\\Documents\\\\GitHub\\\\react-nodejs-frontend\\\\src\\\\contexts\\\\auth.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { createContext, useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { api, createSession } from '../services/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext();\nexport const AuthProvider = _ref => {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    const user = localStorage.getItem(\"user\");\n    const token = localStorage.getItem(\"token\");\n\n    if (user) {\n      setUser(JSON.parse(user));\n      api.defaults.headers.Authorization = `Bearer ${token}`;\n    }\n\n    setLoading(false);\n  }, []);\n\n  const login = async (email, password) => {\n    const response = await createSession(email, password);\n    localStorage.setItem(\"user\", JSON.stringify(response.data.user));\n    localStorage.setItem(\"token\", response.data.token);\n    api.defaults.headers.Authorization = `Bearer ${response.data.token}`;\n    setUser(response.data.user);\n    navigate(\"/\");\n  };\n\n  const logout = () => {\n    localStorage.removeItem(\"user\");\n    localStorage.removeItem(\"token\");\n    api.defaults.headers.Authorization = null;\n    setUser(null);\n    navigate(\"/login\");\n  };\n\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      authenticated: !!user,\n      user,\n      loading,\n      logout\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 45,\n    columnNumber: 5\n  }, this);\n};\n\n_s(AuthProvider, \"bMs6vkxBNdJdvAQTZITyVwx4nss=\", false, function () {\n  return [useNavigate];\n});\n\n_c = AuthProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useEffect","useState","useNavigate","api","createSession","AuthContext","AuthProvider","children","navigate","user","setUser","loading","setLoading","localStorage","getItem","token","JSON","parse","defaults","headers","Authorization","login","email","password","response","setItem","stringify","data","logout","removeItem","authenticated"],"sources":["C:/Users/Tiago - DARM/Documents/GitHub/react-nodejs-frontend/src/contexts/auth.jsx"],"sourcesContent":["import React, {createContext, useEffect, useState} from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nimport {api, createSession } from '../services/api';\r\n\r\nexport const AuthContext = createContext();\r\n\r\nexport const AuthProvider = ({children}) => {\r\n    const navigate = useNavigate()\r\n    const [user, setUser] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        const user = localStorage.getItem(\"user\");\r\n        const token = localStorage.getItem(\"token\");\r\n\r\n        if (user) {\r\n            setUser(JSON.parse(user))\r\n            api.defaults.headers.Authorization = `Bearer ${token}`\r\n        }\r\n\r\n        setLoading(false);\r\n    }, []);\r\n\r\n    const login = async (email, password) => {\r\n        const response = await createSession(email, password);\r\n\r\n        localStorage.setItem(\"user\", JSON.stringify(response.data.user))\r\n        localStorage.setItem(\"token\", response.data.token)\r\n\r\n        api.defaults.headers.Authorization = `Bearer ${response.data.token}`\r\n        setUser(response.data.user);\r\n        navigate(\"/\");\r\n    }\r\n\r\n    const logout = () => {\r\n        localStorage.removeItem(\"user\");\r\n        localStorage.removeItem(\"token\");\r\n        api.defaults.headers.Authorization = null\r\n        setUser(null);\r\n        navigate(\"/login\")\r\n    }\r\n\r\n    return (\r\n    <AuthContext.Provider\r\n        value={{\r\n            authenticated: !!user,\r\n            user,\r\n            loading,\r\n            logout,\r\n        }}>\r\n        {children}\r\n    </AuthContext.Provider>\r\n    )\r\n}\r\n"],"mappings":";;;AAAA,OAAOA,KAAP,IAAeC,aAAf,EAA8BC,SAA9B,EAAyCC,QAAzC,QAAwD,OAAxD;AACA,SAASC,WAAT,QAA4B,kBAA5B;AAEA,SAAQC,GAAR,EAAaC,aAAb,QAAkC,iBAAlC;;AAEA,OAAO,MAAMC,WAAW,gBAAGN,aAAa,EAAjC;AAEP,OAAO,MAAMO,YAAY,GAAG,QAAgB;EAAA;;EAAA,IAAf;IAACC;EAAD,CAAe;EACxC,MAAMC,QAAQ,GAAGN,WAAW,EAA5B;EACA,MAAM,CAACO,IAAD,EAAOC,OAAP,IAAkBT,QAAQ,CAAC,IAAD,CAAhC;EACA,MAAM,CAACU,OAAD,EAAUC,UAAV,IAAwBX,QAAQ,CAAC,IAAD,CAAtC;EAEAD,SAAS,CAAC,MAAM;IACZ,MAAMS,IAAI,GAAGI,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAb;IACA,MAAMC,KAAK,GAAGF,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAd;;IAEA,IAAIL,IAAJ,EAAU;MACNC,OAAO,CAACM,IAAI,CAACC,KAAL,CAAWR,IAAX,CAAD,CAAP;MACAN,GAAG,CAACe,QAAJ,CAAaC,OAAb,CAAqBC,aAArB,GAAsC,UAASL,KAAM,EAArD;IACH;;IAEDH,UAAU,CAAC,KAAD,CAAV;EACH,CAVQ,EAUN,EAVM,CAAT;;EAYA,MAAMS,KAAK,GAAG,OAAOC,KAAP,EAAcC,QAAd,KAA2B;IACrC,MAAMC,QAAQ,GAAG,MAAMpB,aAAa,CAACkB,KAAD,EAAQC,QAAR,CAApC;IAEAV,YAAY,CAACY,OAAb,CAAqB,MAArB,EAA6BT,IAAI,CAACU,SAAL,CAAeF,QAAQ,CAACG,IAAT,CAAclB,IAA7B,CAA7B;IACAI,YAAY,CAACY,OAAb,CAAqB,OAArB,EAA8BD,QAAQ,CAACG,IAAT,CAAcZ,KAA5C;IAEAZ,GAAG,CAACe,QAAJ,CAAaC,OAAb,CAAqBC,aAArB,GAAsC,UAASI,QAAQ,CAACG,IAAT,CAAcZ,KAAM,EAAnE;IACAL,OAAO,CAACc,QAAQ,CAACG,IAAT,CAAclB,IAAf,CAAP;IACAD,QAAQ,CAAC,GAAD,CAAR;EACH,CATD;;EAWA,MAAMoB,MAAM,GAAG,MAAM;IACjBf,YAAY,CAACgB,UAAb,CAAwB,MAAxB;IACAhB,YAAY,CAACgB,UAAb,CAAwB,OAAxB;IACA1B,GAAG,CAACe,QAAJ,CAAaC,OAAb,CAAqBC,aAArB,GAAqC,IAArC;IACAV,OAAO,CAAC,IAAD,CAAP;IACAF,QAAQ,CAAC,QAAD,CAAR;EACH,CAND;;EAQA,oBACA,QAAC,WAAD,CAAa,QAAb;IACI,KAAK,EAAE;MACHsB,aAAa,EAAE,CAAC,CAACrB,IADd;MAEHA,IAFG;MAGHE,OAHG;MAIHiB;IAJG,CADX;IAAA,UAOKrB;EAPL;IAAA;IAAA;IAAA;EAAA,QADA;AAWH,CA/CM;;GAAMD,Y;UACQJ,W;;;KADRI,Y"},"metadata":{},"sourceType":"module"}